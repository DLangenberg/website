<!-- HTML CODE -->
<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FTE Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    body {
  font-family: 'Inter', sans-serif;
  background-color: #f6f7f9;
  padding: 0;
  margin: 0;
  color: #1c1c1c;
}
    h2 {
      text-align: center;
      color: #334e68;
      margin-bottom: 20px;
    }
    .controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .controls label {
      font-weight: 600;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .week-block {
      max-width: 1100px;
      margin-left: auto;
      margin-right: auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      margin-bottom: 20px;
      overflow: hidden;
    }
    .week-block h3 {
      margin: 0;
      padding: 16px;
      background-color: #f0f4f8;
      color: #334e68;
      border-bottom: 1px solid #e1e8ed;
    }
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #e1e8ed;
      padding: 14px 16px;
      text-align: center;
    }
    th {
      background-color: #f0f4f8;
      color: #334e68;
    }
    input[type="number"], select {
    min-width: 200px;
    padding: 10px;
    font-size: 15px;
    background-color: white;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    border: 1px solid #bcccdc;
    border-radius: 6px;
    }
    .timepicker {
      padding: 6px 10px;
      border: 1px solid #bcccdc;
      border-radius: 6px;
      font-size: 14px;
      width: 100px;
    }
    button {
      display: block;
      margin: 30px auto;
      padding: 12px 24px;
      background: #486581;
      color: white;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #334e68;
    }
    #result {
      text-align: center;
      font-weight: 600;
      margin-top: 20px;
      font-size: 18px;
      color: #102a43;
    }
    #advice {
      text-align: center;
      margin-top: 10px;
      font-size: 16px;
      color: #486581;
      font-weight: 500;
    }
    .container {
    max-width: 1100px;
    margin: 0 auto;
    width: 100%;
    padding: 0 16px;
  }
  .section-box {
    margin-left: auto;
    margin-right: auto;
    max-width: 1100px;
    margin: 40px auto;
    padding: 24px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    overflow: hidden;
    border: 1px solid #e1e8ed;
  }
</style>
</head>
<body>
  <div class="container">
  <header style="background: white; padding: 16px 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); display: flex; align-items: center; position: relative; border-radius: 12px 12px 12px 12px; overflow: hidden;">
  <img src="https://careers.recruiteecdn.com/image/upload/q_auto,f_auto,w_400,c_limit/production/images/BU02/9YwXqBFppGoi.png" alt="CB Logo" style="height: 72px;">
  <h2 style="margin: 0 auto; font-size: 28px; color: #0069b4; position: absolute; left: 50%; transform: translateX(-50%);">FTE Calculator CB</h2>
</header>

  <section class="section-box">
  <div class="controls" style="width: 100%; display: flex; flex-wrap: wrap; gap: 32px; justify-content: center;">
  <label>
    Boven-CAO:
    <select id="bovenCaoToggle">
      <option value="nee" selected>Nee</option>
      <option value="ja">Ja</option>
    </select>
  </label>
  <label>
    Uren/week per 1 FTE:
    <input type="number" id="fteHoursInput" value="38" min="1">
  </label>
  <label>
    Aantal weken ploegendienst:
    <select id="weeksSelect">
      <option value="1" selected>1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
    </select>
  </label>
  <label>
    Aantal ATV-dagen dat je wilt bijkopen:
    <input type="number" id="atvBijkopenInput" value="0" min="0" max="10">
  </label>
</div>
</section>
<p style="text-align:center; max-width: 600px; margin: 0 auto 30px auto; line-height: 1.6;">Vul de werktijden per dag in inclusief pauzes. De calculator houdt rekening met diensten die over middernacht gaan √©n 5 minuten looptijd per shift.</p>
  <div id="shiftContainer"></div>

  <div style="text-align: center; margin-top: 40px;">
  <button onclick="calculateFTE()" style="padding: 14px 32px; font-size: 16px; border-radius: 10px; background-color: #0069b4; color: white; font-weight: 600; border: none; cursor: pointer;">üìä Bereken FTE</button>
</div>
  <div id="result"></div>
  <div id="advice"></div>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
    const dagen = ["Zondag", "Maandag", "Dinsdag", "Woensdag", "Donderdag", "Vrijdag", "Zaterdag"];

    function generateTable() {
      const weeks = parseInt(document.getElementById("weeksSelect").value);
      const container = document.getElementById("shiftContainer");
      container.innerHTML = "";

      for (let w = 0; w < weeks; w++) {
        const weekDiv = document.createElement("div");
        weekDiv.className = "week-block";
        weekDiv.innerHTML = `<h3>Week ${w + 1}</h3>`;

        const table = document.createElement("table");
        const thead = document.createElement("thead");
        thead.innerHTML = `
          <tr>
            <th>Dag</th>
            <th>Starttijd</th>
            <th>Eindtijd</th>
            <th>Pauze (min)</th>
          </tr>
        `;
        table.appendChild(thead);

        const tbody = document.createElement("tbody");

        for (let d = 0; d < 7; d++) {
          const isWerkdag = d >= 1 && d <= 5;
          const defaultStart = isWerkdag ? "08:49" : "";
          const defaultEnd = isWerkdag ? "17:00" : "";
          const defaultBreak = isWerkdag ? 30 : 0;

          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${dagen[d]}</td>
            <td><input class="timepicker" name="start" value="${defaultStart}" style="width: 110px; padding: 8px; font-size: 14px; text-align: center;"></td>
            <td><input class="timepicker" name="end" value="${defaultEnd}" style="width: 110px; padding: 8px; font-size: 14px; text-align: center;"></td>
            <td><input type="number" name="break" value="${defaultBreak}" style="width: 110px; padding: 8px; font-size: 14px; text-align: center;"></td>
          `;
          tbody.appendChild(row);
        }

        table.appendChild(tbody);
        weekDiv.appendChild(table);
        container.appendChild(weekDiv);
      }

      flatpickr(".timepicker", {
        enableTime: true,
        noCalendar: true,
        dateFormat: "H:i",
        time_24hr: true,
        allowInput: true,
        clickOpens: true,
        disableMobile: true,
        onReady: function(selectedDates, dateStr, instance) {
          instance._input.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
              instance.close();
            }
          });
          instance._input.addEventListener('input', function(e) {
            let val = e.target.value.replace(/[^0-9]/g, "");
            if (/^\d{4}$/.test(val)) {
                const padded = val.padStart(4, '0');
                const hours = Number(padded.slice(0, 2));
                const minutes = Number(padded.slice(2, 4));
                if (hours < 24 && minutes < 60) {
                const formatted = hours.toString().padStart(2, '0') + ':' + minutes.toString().padStart(2, '0');
                e.target._flatpickr.setDate(formatted, true);
                e.target.value = formatted;
                }
            }
            });
        }
      });
    }

    document.getElementById("weeksSelect").addEventListener("change", generateTable);
    window.addEventListener("DOMContentLoaded", generateTable);
  function timeToMinutes(t) {
  if (!t) return null;
  const [h, m] = t.split(":").map(Number);
  return h * 60 + m;
}

function calculateFTE() {
  const rows = document.querySelectorAll("#shiftContainer tbody tr");
  const fteHours = parseFloat(document.getElementById("fteHoursInput").value) || 36;
  const numWeeks = parseInt(document.getElementById("weeksSelect").value);
  const extraATV = parseInt(document.getElementById("atvBijkopenInput").value) || 0;

  let totalMinutes = 0;

  rows.forEach(row => {
    const start = row.querySelector("input[name='start']").value;
    const end = row.querySelector("input[name='end']").value;
    const pause = parseInt(row.querySelector("input[name='break']").value) || 0;

    if (start && end) {
      let startMin = timeToMinutes(start);
      let endMin = timeToMinutes(end);
      if (endMin <= startMin) endMin += 1440;
      let worked = endMin - startMin - pause;
      if (start && end && !(startMin === endMin && pause === 0)) {
        worked -= 5;
      }
      totalMinutes += worked > 0 ? worked : 0;
    }
  });

  const avgMinutes = totalMinutes / numWeeks;
  const avgHours = avgMinutes / 60;
  const fte = avgHours / fteHours;

  document.getElementById("result").innerHTML =
    `Gemiddeld aantal uur per week: <strong>${avgHours.toFixed(3)} uur</strong><br>` +
    `FTE (op basis van ${fteHours}u): <strong>${fte.toFixed(3)}</strong>`;

  const advice = document.getElementById("advice");
  const bovenCao = document.getElementById("bovenCaoToggle").value === "ja";
  const atvDagen = bovenCao ? 16 : 13;
  const bijkoopbareDagen = 10;
  const vakantieDagen = 25;
  const minimaalOpTeNemen = 0;
  const verschilUur = (1 - fte) * fteHours * 52;
  const uurPerDag = fteHours / 5;
  const benodigdeDagen = verschilUur / uurPerDag;

  if (fte >= 0.85 && fte < 1.0) {
    let boodschap = `üìå Tip: Het is <strong>mogelijk</strong> voordeliger om fulltime te werken! Bij 1 FTE krijg je ${atvDagen} ATV-dagen en 25 vakantiedagen maar ook 100% pensioenopbouw. `;

    let resterend = benodigdeDagen;
    let uitATV = Math.min(resterend, atvDagen);
    resterend -= uitATV;

    let uitBijkoop = Math.min(resterend, extraATV);
    resterend -= uitBijkoop;

    let uitVakantie = Math.min(resterend, 10);
    resterend -= uitVakantie;

    const vakantieOver = vakantieDagen - minimaalOpTeNemen - uitVakantie;

    boodschap += `<br>Je moet ongeveer <strong>${benodigdeDagen.toFixed(1)}</strong> dagen compenseren,`;
    boodschap += ` je gebruikt dan <strong>${uitATV.toFixed(1)}</strong> ATV-dagen, <strong>${uitVakantie.toFixed(1)}</strong> vakantiedagen, <strong>${uitBijkoop.toFixed(1)}</strong> bijkoopdagen.`;
    const overATV = (atvDagen + extraATV) - (uitATV + uitBijkoop);
const overVakantie = (vakantieDagen + atvDagen + extraATV) - (uitVakantie + uitATV + uitBijkoop);
boodschap += `<br><div style='display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 10px;'>
  <span style='font-size: 28px;'>üå¥</span>
  <span>Je houdt nog <strong>${overVakantie.toFixed(1)}</strong> atv/ vakantiedagen over na compensatie!</span>
</div>`;
    if (resterend > 0.1 && resterend > overVakantie) {
      boodschap += `<br><strong>‚ö†Ô∏è Je komt nog ${resterend.toFixed(1)} dagen tekort.</strong>`;
    }

    advice.innerHTML = boodschap;
  } else {
    advice.innerHTML = "";
  }
}
</script>
<footer style="text-align:center; margin-top: 40px; font-size: 14px; color: #627d98;">
  ¬© Damian Langenberg
</footer>
  </div>
</body>
</html>
